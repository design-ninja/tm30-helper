<!DOCTYPE html>
<html lang="en" data-i18n-title="options.title">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thai TM30 Helper - Manage Profiles</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body class="Options">
    <!-- PIN Lock Screen -->
    <div id="pin-lock" class="PinLock PinLock_fullscreen" style="display: none;">
        <div class="PinLock__Card">
            <div class="PinLock__Icon">üîí</div>
            <h3 class="PinLock__Title" data-i18n="pin.title">Enter PIN</h3>
            <div class="PinDigits PinDigits_lock" id="pin-lock-digits">
                <input type="password" class="PinDigits__Input" maxlength="1" inputmode="numeric" pattern="[0-9]">
                <input type="password" class="PinDigits__Input" maxlength="1" inputmode="numeric" pattern="[0-9]">
                <input type="password" class="PinDigits__Input" maxlength="1" inputmode="numeric" pattern="[0-9]">
                <input type="password" class="PinDigits__Input" maxlength="1" inputmode="numeric" pattern="[0-9]">
            </div>
            <p id="pin-error" class="PinLock__Error" style="display: none;" data-i18n="pin.error">Incorrect PIN</p>
            <p id="pin-attempts" class="PinLock__Attempts" style="display: none;"></p>
            <button id="pin-reset-btn" class="PinLock__ResetBtn" style="display: none;" data-i18n="pin.forgot">Forgot
                PIN? Reset all data</button>
        </div>
    </div>

    <!-- Main Content (hidden until PIN check completes) -->
    <div id="main-content" class="Options__Container" style="display: none;">
        <header class="Options__Header">
            <img src="icons/icon128.png" alt="Icon" class="Options__HeaderIcon">
            <h1 class="Options__Title" data-i18n="options.header">Thai TM30 Helper</h1>
            <p class="Options__Subtitle" data-i18n="options.subtitle">Save profiles to auto-fill TM30 forms instantly
            </p>
        </header>

        <section class="Options__Section">
            <h2 id="form-title" class="Options__SectionTitle" data-i18n="options.formTitle.add">üë§ Add New Person</h2>
            <form id="person-form">
                <input type="hidden" id="personId">
                <div class="Options__FormGrid">
                    <div class="Options__FormGroup">
                        <label for="firstName" class="Options__Label"><span data-i18n="options.label.firstName">First
                                Name</span> <span class="required">*</span></label>
                        <input type="text" id="firstName" class="Options__Input" required>
                    </div>
                    <div class="Options__FormGroup">
                        <label for="lastName" class="Options__Label"><span data-i18n="options.label.lastName">Last
                                Name</span> <span class="required">*</span></label>
                        <input type="text" id="lastName" class="Options__Input" required>
                    </div>
                    <div class="Options__FormGroup">
                        <label for="passportNo" class="Options__Label"><span
                                data-i18n="options.label.passportNo">Passport Number</span> <span
                                class="required">*</span></label>
                        <input type="text" id="passportNo" class="Options__Input" required>
                    </div>
                    <div class="Options__FormGroup">
                        <label for="nationality" class="Options__Label"><span
                                data-i18n="options.label.nationality">Nationality</span> <span
                                class="required">*</span></label>
                        <div class="Options__Autocomplete">
                            <input type="text" id="nationality" class="Options__Input" autocomplete="off" required>
                            <input type="hidden" id="nationalityCode">
                            <div id="nationality-dropdown" class="Options__AutocompleteDropdown"></div>
                        </div>
                    </div>
                    <div class="Options__FormGroup">
                        <label for="gender" class="Options__Label"><span data-i18n="options.label.gender">Gender</span>
                            <span class="required">*</span></label>
                        <select id="gender" class="Options__Select" required>
                            <option value="M" data-i18n="options.gender.male">Male</option>
                            <option value="F" data-i18n="options.gender.female">Female</option>
                        </select>
                    </div>
                    <div class="Options__FormGroup">
                        <label for="birthDate" class="Options__Label" data-i18n="options.label.birthDate">Birth
                            Date</label>
                        <input type="text" id="birthDate" class="Options__Input" pattern="\d{2}/\d{2}/\d{4}"
                            placeholder="DD/MM/YYYY">
                    </div>
                    <div class="Options__FormGroup">
                        <label for="checkInDate" class="Options__Label" data-i18n="options.label.checkInDate">Check-in
                            Date</label>
                        <input type="text" id="checkInDate" class="Options__Input" pattern="\d{2}/\d{2}/\d{4}"
                            placeholder="DD/MM/YYYY">
                    </div>
                    <div class="Options__FormGroup">
                        <label for="checkOutDate" class="Options__Label"
                            data-i18n="options.label.checkOutDate">Check-out Date</label>
                        <input type="text" id="checkOutDate" class="Options__Input" pattern="\d{2}/\d{2}/\d{4}"
                            placeholder="DD/MM/YYYY">
                    </div>
                    <div class="Options__FormGroup">
                        <label for="phoneNo" class="Options__Label" data-i18n="options.label.phoneNo">Phone
                            Number</label>
                        <input type="text" id="phoneNo" class="Options__Input">
                    </div>
                </div>
                <div class="Options__FormActions">
                    <button type="submit" id="submit-btn" class="Options__BtnPrimary" data-i18n="options.btn.save">Save
                        Profile</button>
                    <button type="button" id="cancel-edit" class="Options__BtnSecondary" style="display: none;"
                        data-i18n="options.btn.cancel">Cancel</button>
                </div>
            </form>
        </section>

        <section class="Options__Section">
            <h2 class="Options__SectionTitle" data-i18n="options.savedProfiles">üë• Saved Profiles</h2>
            <div id="person-list" class="Options__PersonList">
                <!-- Persons will be injected here -->
                <p class="EmptyState" data-i18n="options.emptyState">No profiles saved yet. Add your first person above.
                </p>
            </div>
        </section>

        <section class="Options__Section">
            <h2 class="Options__SectionTitle" data-i18n="options.importExport.title">üîÑ Import / Export</h2>
            <p class="Options__SectionDescription" data-i18n="options.importExport.description">Export profiles to Excel
                for bulk TM30 submission, or import from an existing template.</p>
            <div class="Options__ImportExportActions">
                <button type="button" id="export-excel-btn" class="Options__BtnPrimary"
                    data-i18n="options.btn.exportExcel">Export to Excel</button>
                <button type="button" id="import-excel-btn" class="Options__BtnSecondary"
                    data-i18n="options.btn.importExcel">Import from Excel</button>
                <input type="file" id="import-file-input" accept=".xls,.xlsx" style="display: none;">
            </div>
        </section>

        <section class="Options__Section">
            <div class="Options__SectionHeader">
                <h2 class="Options__SectionTitle" data-i18n="options.security.title">üîê PIN code</h2>
                <span id="pin-status-badge" class="Options__Badge Options__Badge_disabled"
                    data-i18n="options.security.badgeNotSet">Not set</span>
            </div>
            <p class="Options__SectionDescription" data-i18n="options.security.description">Protect your data with a PIN
                code</p>

            <!-- PIN Setup (when PIN is not set) -->
            <div id="pin-setup" class="Options__SecurityBlock">
                <div class="Options__PinSetupForm">
                    <div class="Options__PinInputGroup">
                        <label class="Options__Label" data-i18n="options.security.newPin">New PIN</label>
                        <div class="PinDigits" id="new-pin-digits">
                            <input type="password" class="PinDigits__Input" maxlength="1" inputmode="numeric"
                                pattern="[0-9]">
                            <input type="password" class="PinDigits__Input" maxlength="1" inputmode="numeric"
                                pattern="[0-9]">
                            <input type="password" class="PinDigits__Input" maxlength="1" inputmode="numeric"
                                pattern="[0-9]">
                            <input type="password" class="PinDigits__Input" maxlength="1" inputmode="numeric"
                                pattern="[0-9]">
                        </div>
                    </div>
                    <div class="Options__PinInputGroup">
                        <label class="Options__Label" data-i18n="options.security.confirmPin">Confirm PIN</label>
                        <div class="PinDigits" id="confirm-pin-digits">
                            <input type="password" class="PinDigits__Input" maxlength="1" inputmode="numeric"
                                pattern="[0-9]">
                            <input type="password" class="PinDigits__Input" maxlength="1" inputmode="numeric"
                                pattern="[0-9]">
                            <input type="password" class="PinDigits__Input" maxlength="1" inputmode="numeric"
                                pattern="[0-9]">
                            <input type="password" class="PinDigits__Input" maxlength="1" inputmode="numeric"
                                pattern="[0-9]">
                        </div>
                    </div>
                    <button type="button" id="set-pin-btn" class="Options__BtnPrimary"
                        data-i18n="options.security.setPin">Set PIN</button>
                </div>
            </div>

            <!-- PIN Manage (when PIN is set) -->
            <div id="pin-manage" class="Options__SecurityBlock" style="display: none;">
                <div class="Options__FormGroup">
                    <label class="Options__Label" data-i18n="options.security.lockTimeout">Lock after inactivity</label>
                    <select id="lock-timeout-select" class="Options__Select Options__Select_auto">
                        <option value="30000" data-i18n="options.security.timeout.30s">30 seconds</option>
                        <option value="60000" data-i18n="options.security.timeout.1m">1 minute</option>
                        <option value="120000" data-i18n="options.security.timeout.2m">2 minutes</option>
                        <option value="180000" data-i18n="options.security.timeout.3m">3 minutes</option>
                        <option value="240000" data-i18n="options.security.timeout.4m">4 minutes</option>
                        <option value="300000" data-i18n="options.security.timeout.5m" selected>5 minutes</option>
                        <option value="600000" data-i18n="options.security.timeout.10m">10 minutes</option>
                    </select>
                </div>

                <div class="Options__SecurityActions">
                    <button type="button" id="change-pin-btn" class="Options__BtnSecondary"
                        data-i18n="options.security.changePin">Change PIN</button>
                    <button type="button" id="remove-pin-btn" class="Options__BtnDanger"
                        data-i18n="options.security.removePin">Remove PIN</button>
                </div>
            </div>
        </section>

        <footer class="Options__Footer">
            <div class="Options__FooterLeft">
                <label class="Options__FooterLabel" data-i18n="options.language">Language</label>
                <select id="language-selector" class="Options__LanguageSelect">
                    <option value="en">English</option>
                    <option value="th">‡πÑ‡∏ó‡∏¢</option>
                </select>
            </div>
            <div class="Options__FooterRight">
                <span data-i18n="options.madeBy">Made by</span> <a href="https://lirik.pro/en" target="_blank"
                    class="Options__FooterLink">lirik</a> <span data-i18n="options.withLove">with</span> üñ§
            </div>
        </footer>
    </div>
    <script src="lib/xlsx.full.min.js"></script>
    <script src="locales/en.js"></script>
    <script src="locales/th.js"></script>
    <script src="i18n.js"></script>
    <script src="storage.js"></script>
    <script src="nationalities.js"></script>
    <script src="mock-data.js"></script>
    <script src="pin.js"></script>
    <script src="options.js"></script>
</body>

</html>