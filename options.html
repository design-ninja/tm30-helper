<!DOCTYPE html>
<html lang="en" data-i18n-title="options.title">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thai TM-30 Helper - Manage Profiles</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body class="Options">
    <div class="Options__Container">
        <header class="Options__Header">
            <img src="icons/icon128.png" alt="Icon" class="Options__HeaderIcon">
            <h1 class="Options__Title" data-i18n="options.header">Thai TM-30 Helper</h1>
            <p class="Options__Subtitle" data-i18n="options.subtitle">Save profiles to auto-fill TM30 forms instantly
            </p>
        </header>

        <section class="Options__Section">
            <h2 id="form-title" class="Options__SectionTitle" data-i18n="options.formTitle.add">Add New Person</h2>
            <form id="person-form">
                <input type="hidden" id="personId">
                <div class="Options__FormGrid">
                    <div class="Options__FormGroup">
                        <label for="firstName" class="Options__Label"><span data-i18n="options.label.firstName">First
                                Name</span> <span class="required">*</span></label>
                        <input type="text" id="firstName" class="Options__Input" required>
                    </div>
                    <div class="Options__FormGroup">
                        <label for="lastName" class="Options__Label"><span data-i18n="options.label.lastName">Last
                                Name</span> <span class="required">*</span></label>
                        <input type="text" id="lastName" class="Options__Input" required>
                    </div>
                    <div class="Options__FormGroup">
                        <label for="passportNo" class="Options__Label"><span
                                data-i18n="options.label.passportNo">Passport Number</span> <span
                                class="required">*</span></label>
                        <input type="text" id="passportNo" class="Options__Input" required>
                    </div>
                    <div class="Options__FormGroup">
                        <label for="nationality" class="Options__Label"><span
                                data-i18n="options.label.nationality">Nationality</span> <span
                                class="required">*</span></label>
                        <div class="Options__Autocomplete">
                            <input type="text" id="nationality" class="Options__Input" autocomplete="off" required>
                            <input type="hidden" id="nationalityCode">
                            <div id="nationality-dropdown" class="Options__AutocompleteDropdown"></div>
                        </div>
                    </div>
                    <div class="Options__FormGroup">
                        <label for="gender" class="Options__Label"><span data-i18n="options.label.gender">Gender</span>
                            <span class="required">*</span></label>
                        <select id="gender" class="Options__Select" required>
                            <option value="M" data-i18n="options.gender.male">Male</option>
                            <option value="F" data-i18n="options.gender.female">Female</option>
                        </select>
                    </div>
                    <div class="Options__FormGroup">
                        <label for="birthDate" class="Options__Label" data-i18n="options.label.birthDate">Birth
                            Date</label>
                        <input type="text" id="birthDate" class="Options__Input" pattern="\d{2}/\d{2}/\d{4}"
                            placeholder="DD/MM/YYYY">
                    </div>
                    <div class="Options__FormGroup">
                        <label for="checkInDate" class="Options__Label" data-i18n="options.label.checkInDate">Check-in
                            Date</label>
                        <input type="text" id="checkInDate" class="Options__Input" pattern="\d{2}/\d{2}/\d{4}"
                            placeholder="DD/MM/YYYY">
                    </div>
                    <div class="Options__FormGroup">
                        <label for="checkOutDate" class="Options__Label"
                            data-i18n="options.label.checkOutDate">Check-out Date</label>
                        <input type="text" id="checkOutDate" class="Options__Input" pattern="\d{2}/\d{2}/\d{4}"
                            placeholder="DD/MM/YYYY">
                    </div>
                    <div class="Options__FormGroup">
                        <label for="phoneNo" class="Options__Label" data-i18n="options.label.phoneNo">Phone
                            Number</label>
                        <input type="text" id="phoneNo" class="Options__Input">
                    </div>
                </div>
                <div class="Options__FormActions">
                    <button type="submit" id="submit-btn" class="Options__BtnPrimary" data-i18n="options.btn.save">Save
                        Profile</button>
                    <button type="button" id="cancel-edit" class="Options__BtnSecondary" style="display: none;"
                        data-i18n="options.btn.cancel">Cancel</button>
                </div>
            </form>
        </section>

        <section class="Options__Section">
            <h2 class="Options__SectionTitle" data-i18n="options.savedProfiles">Saved Profiles</h2>
            <div id="person-list" class="Options__PersonList">
                <!-- Persons will be injected here -->
                <p class="EmptyState" data-i18n="options.emptyState">No profiles saved yet. Add your first person above.
                </p>
            </div>
        </section>

        <section class="Options__Section">
            <h2 class="Options__SectionTitle" data-i18n="options.importExport.title">Import / Export</h2>
            <p class="Options__SectionDescription" data-i18n="options.importExport.description">Export profiles to Excel
                for bulk TM30 submission, or import from an existing template.</p>
            <div class="Options__ImportExportActions">
                <button type="button" id="export-excel-btn" class="Options__BtnPrimary"
                    data-i18n="options.btn.exportExcel">Export to Excel</button>
                <button type="button" id="import-excel-btn" class="Options__BtnSecondary"
                    data-i18n="options.btn.importExcel">Import from Excel</button>
                <input type="file" id="import-file-input" accept=".xls,.xlsx" style="display: none;">
            </div>
        </section>
    </div>
    <script src="lib/xlsx.full.min.js"></script>
    <script src="locales/en.js"></script>
    <script src="locales/th.js"></script>
    <script src="i18n.js"></script>
    <script src="storage.js"></script>
    <script src="nationalities.js"></script>
    <script src="mock-data.js"></script>
    <script src="options.js"></script>
</body>

</html>